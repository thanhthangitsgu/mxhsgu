<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>THÔNG BÁO MÙA HÈ XANH</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="icon" type="image/x-icon" href="/img/MHX.png" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,600;1,700;1,800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,700;1,900&family=Teko:wght@300&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <!-- SCRIPT -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.0/gsap.min.js"></script>
    <script src="./confetti/dist/index.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>

    <style>
      p {
        margin-block-start: 0em;
        margin-block-end: 0em;
      }
      #content {
        overflow: hidden;
        height: 97vh;
        position: relative;
        justify-content: center;
        display: flex;
        align-items: center;
        font-family: "Montserrat", sans-serif;
      }
      #my-canvas {
        position: absolute;
        z-index: -1000;
      }
      .notification {
        width: 80%;
        height: 50%;
        border-radius: 1rem;
        box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
        background: linear-gradient(to right, #11998e, #38ef7d);
        text-align: center;
        color: white;
        font-size: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .top {
        font-weight: 600;
      }
      .name {
        font-weight: 900;
        font-size: 3rem;
      }
      .logo {
        margin-top: 0.5rem;
        position: absolute;
        display: flex;
        gap: 0 0.5rem;
        top: 0;
      }
      .text {
        padding: 1rem;
        font-weight: 600;
      }
      .img-mxh {
        width: 5rem;
        height: 5rem;
      }
      .img-mxh img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }
      .img-typo {
        width: 20rem;
        height: 20rem;
      }
      .img-typo img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }
      @media screen and (max-width: 720px) {
        .notification{
            flex-direction: column;
            font-size: 1rem;
        }
        .name{
            font-size: 1.5rem;
        }
        .img-typo{
            width: 8rem;
            height: 8rem;
        }
      }
    </style>
  </head>
  <body>
    <audio id="audio">
      <source src="/img/cg.m4a" type="audio/ogg" id="mp" />
    </audio>
    <div id="content" class="">
      <div class="logo">
        <div class="img-mxh">
          <img src="/img/dtn.png" alt="" />
        </div>
        <div class="img-mxh">
          <img src="/img/DHSG.png" alt="" />
        </div>
        <div class="img-mxh">
          <img src="/img/hsv.png" alt="" />
        </div>
        <div class="img-mxh">
          <img src="/img/MHX.png" alt="" />
        </div>
      </div>
      <canvas id="my-canvas"></canvas>
      <div class="notification">
        <div class="typo">
          <div class="img-typo">
            <img src="img/typo.png" alt="" />
          </div>
        </div>
        <div class="main">
          <p class="top">Chúc mừng bạn</p>
          <p class="name" id="name">Phan Thanh Thắng</p>
          <p class="text">
            Đã trở thành chiến sĩ tình nguyện MÙA HÈ XANH <br />trường Đại học
            Sài Gòn lần thứ 30 - năm 2023
          </p>
        </div>
      </div>
    </div>
    <!-- Modal -->
    <div
      class="modal fade"
      id="modal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
      data-backdrop="static"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">
              Nhập mã số sinh viên của bạn
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <input
              type="text"
              name="mssv"
              id="mssv"
              placeholder="Mã số sinh viên"
              class="form-control"
            />
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-success" id="btn">Ok</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      var confettiSettings = {
        target: "my-canvas",
        max: "200",
        size: "1",
        animate: true,
        props: ["circle", "square", "triangle", "line"],
        colors: [
          [165, 104, 246],
          [230, 61, 135],
          [0, 199, 228],
          [253, 214, 126],
        ],
        clock: "25",
        rotate: false,
        width: "1280",
        height: "616",
        start_from_edge: false,
        respawn: true,
      };
      var confetti = new ConfettiGenerator(confettiSettings);
      confetti.render();

      $("#btn").on("click", () => {
        fetch(
          "https://sheet.best/api/sheets/7b4179af-e5b5-4c22-be3f-838d98228b04"
        )
          .then((response) => response.json())
          .then((data) => {
            const length = data.length;
            const text = $("#mssv").val();
            fetch(
              "https://sheet.best/api/sheets/7b4179af-e5b5-4c22-be3f-838d98228b04",
              {
                method: "POST",
                mode: "cors",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  mssv: text,
                  name1: `= INDEX(IMPORTRANGE("https://docs.google.com/spreadsheets/d/1Q70XtFk9wYnoHBX-gfvi1EBLT-vfFe-85Uu3Rlo5oBQ/edit#gid=0";"data!C3:I21000");MATCH($A${
                    length + 2
                  };IMPORTRANGE("https://docs.google.com/spreadsheets/d/1Q70XtFk9wYnoHBX-gfvi1EBLT-vfFe-85Uu3Rlo5oBQ/edit#gid=0";"data!C3:C21000");0);2)`,
                  name2: `= INDEX(IMPORTRANGE("https://docs.google.com/spreadsheets/d/1Q70XtFk9wYnoHBX-gfvi1EBLT-vfFe-85Uu3Rlo5oBQ/edit#gid=0";"data!C3:I21000");MATCH($A${
                    length + 2
                  };IMPORTRANGE("https://docs.google.com/spreadsheets/d/1Q70XtFk9wYnoHBX-gfvi1EBLT-vfFe-85Uu3Rlo5oBQ/edit#gid=0";"data!C3:C21000");0);3)`,
                }),
              }
            )
              .then((r) => r.json())
              .then((data) => {
                setTimeout(() => {
                  fetch(
                    "https://sheet.best/api/sheets/7b4179af-e5b5-4c22-be3f-838d98228b04"
                  )
                    .then((response) => response.json())
                    .then((res) => {
                      console.log(res);
                      $("#modal").modal("hide");
                      $("#content").removeClass("d-none");
                      $("#name").text(
                        res[res.length - 1].name1 +
                          " " +
                          res[res.length - 1].name2
                      );
                      const el = document.getElementById("audio");
                      el.play();
                    });
                }, 1000);
              });
          });
      });

    //   $("#modal").modal("show");
    </script>
  </body>
</html>
